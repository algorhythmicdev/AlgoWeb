/*
 * Motion surfaces and magnetic treatments shared across the site.
 * The legacy utility classes have been removed so the sheet now
 * focuses on the glass "os-window" shell and magnetic card effect.
 */

.os-window {
  position: relative;
  padding: var(--card-padding-lg);
  border-radius: var(--radius-md);
  background: color-mix(in srgb, var(--surface-glass-bg) 86%, transparent 14%);
  border: 1px solid color-mix(in srgb, var(--surface-glass-border) 82%, transparent 18%);
  box-shadow: var(--shadow-lg);
  backdrop-filter: blur(calc(var(--glass-blur) * 0.82)) saturate(1.04);
  -webkit-backdrop-filter: blur(calc(var(--glass-blur) * 0.82)) saturate(1.04);
  overflow: hidden;
  isolation: isolate;
  transition:
    background var(--duration-normal) var(--ease-smooth),
    border-color var(--duration-normal) var(--ease-smooth),
    box-shadow var(--duration-normal) var(--ease-smooth);
  --os-window-hc-bg: var(--bg-elev-1);
  --os-window-hc-border: var(--border);
  --os-window-hc-shadow: none;
  --grid-spot-x: 58%;
  --grid-spot-y: 42%;
  --line-angle: 42deg;
}

.os-window > * {
  position: relative;
  z-index: var(--z-text);
}

html[data-theme='hc'] .os-window {
  background: var(--os-window-hc-bg);
  background-image: none;
  background-blend-mode: normal;
  border: 2px solid var(--os-window-hc-border);
  box-shadow: var(--os-window-hc-shadow);
  backdrop-filter: none;
  -webkit-backdrop-filter: none;
  --grain-opacity: 0;
}

.os-window[data-variant='halo']::before {
  content: '';
  position: absolute;
  inset: -12%;
  background:
    radial-gradient(circle at 30% 30%, color-mix(in srgb, var(--grad-a) 32%, transparent) 0%, transparent 62%),
    radial-gradient(circle at 70% 70%, color-mix(in srgb, var(--grad-b) 28%, transparent) 0%, transparent 68%);
  mix-blend-mode: screen;
  opacity: 0.16;
  filter: blur(12px);
}

.os-window[data-variant='grid']::before {
  content: '';
  position: absolute;
  inset: 0;
  z-index: var(--z-behind);
  pointer-events: none;
  background-image:
    radial-gradient(circle at var(--grid-spot-x) var(--grid-spot-y), color-mix(in srgb, var(--grad-a) 24%, transparent) 0%, transparent 55%),
    linear-gradient(to right, color-mix(in srgb, var(--grad-a) 10%, transparent) 1px, transparent 1px),
    linear-gradient(to bottom, color-mix(in srgb, var(--grad-b) 10%, transparent) 1px, transparent 1px);
  background-size: auto, 34px 34px, 34px 34px;
  opacity: 0.18;
  mix-blend-mode: screen;
}

.os-window[data-variant='grid'] {
  --grid-spot-x: 58%;
  --grid-spot-y: 42%;
}

.os-window[data-variant='line']::before {
  content: '';
  position: absolute;
  inset: -28%;
  z-index: var(--z-behind);
  pointer-events: none;
  background: conic-gradient(
    from var(--line-angle),
    transparent 0 32%,
    color-mix(in srgb, var(--grad-a) 24%, transparent) 48%,
    transparent 72%
  );
  opacity: 0.14;
  mix-blend-mode: screen;
}

.os-window[data-variant='line'] {
  --line-angle: 42deg;
}

.os-window[data-variant='halo']::before,
.os-window[data-variant='grid']::before,
.os-window[data-variant='line']::before {
  transition: opacity var(--duration-hero) var(--ease-out),
    filter var(--duration-hero) var(--ease-out);
}

html[data-theme='hc'] .os-window[data-variant='halo']::before,
html[data-theme='hc'] .os-window[data-variant='grid']::before,
html[data-theme='hc'] .os-window[data-variant='line']::before {
  display: none;
}

@media (prefers-reduced-motion: reduce) {
  .os-window[data-variant]::before {
    animation: none;
    opacity: 0.25;
  }
}
