/* Base defaults (sane fallbacks) */
:root {
  --bg: #0B0E13;            /* default dark background */
  --bg-elev-1: #121722;
  --bg-elev-2: #161C28;
  --text: #F2F5F9;

  --primary: #8A6BFF;       /* Aurora Purple thread */
  --accent-1: #10E3D6;      /* teal/cyan */
  --accent-2: #FFD339;      /* signal yellow */

  --glass-stroke: color-mix(in lab, var(--text) 12%, transparent);
  --focus-ring: 0 0 0 3px color-mix(in lab, var(--primary) 60%, transparent);

  /* Legacy brand tokens for compatibility */
  --brand: var(--primary);
  --brand-2: var(--accent-1);
  --brand-3: var(--accent-2);

  /* Motion */
  --dur-fast: 140ms;
  --dur:      200ms;
  --dur-slow: 360ms;
  --ease: cubic-bezier(.2,.7,.2,1);
}

/* LIGHT */
:root[data-theme="light"] {
  --bg: #F5F7FB;            /* Cloud */
  --bg-elev-1: #FFFFFF;     /* Surface */
  --bg-elev-2: #EEF1F7;     /* Mist */
  --text: #0A0D14;          /* Ink */

  --primary: #6A38FF;
  --accent-1: #0FD6C9;
  --accent-2: #FFD339;

  --glass-stroke: color-mix(in lab, #000 10%, transparent);
  --focus-ring: 0 0 0 3px color-mix(in lab, var(--primary) 60%, transparent);

  /* Legacy brand tokens */
  --brand: var(--primary);
  --brand-2: var(--accent-1);
  --brand-3: var(--accent-2);
}

/* DARK */
:root[data-theme="dark"] {
  --bg: #0B0E13;            /* Night */
  --bg-elev-1: #121722;     /* Graphite */
  --bg-elev-2: #161C28;     /* lighter Graphite */
  --text: #F2F5F9;          /* Snow */

  --primary: #8A6BFF;
  --accent-1: #10E3D6;
  --accent-2: #FFD339;

  --glass-stroke: color-mix(in lab, var(--text) 12%, transparent);
  --focus-ring: 0 0 0 3px color-mix(in lab, var(--primary) 60%, transparent);

  /* Legacy brand tokens */
  --brand: var(--primary);
  --brand-2: var(--accent-1);
  --brand-3: var(--accent-2);
}

/* HIGH CONTRAST (light) */
:root[data-theme="high-contrast"] {
  --bg: #FFFFFF;
  --bg-elev-1: #FFFFFF;
  --bg-elev-2: #F0F3FA;
  --text: #000000;

  --primary: #4400FF;
  --accent-1: #007A73;
  --accent-2: #B78300;

  /* stronger focus ring for HC */
  --focus-ring: 0 0 0 3px #000000;

  /* Legacy brand tokens */
  --brand: var(--primary);
  --brand-2: var(--accent-1);
  --brand-3: var(--accent-2);
}

/* Card/surface helpers already used across the site */
.surface-0 { background: var(--bg); }
.surface-1 { background: var(--bg-elev-1); }
.surface-2 { background: var(--bg-elev-2); }

.card {
  background: var(--bg-elev-1);
  border: 1px solid var(--glass-stroke);
  border-radius: 12px;
  padding: 1rem;
}

.btn-primary {
  background: var(--primary);
  color: var(--text);
  border: 1px solid color-mix(in lab, var(--primary) 30%, var(--text) 10%);
}
.btn-primary:focus-visible { box-shadow: var(--focus-ring); outline: none; }

/* ===== Elevation utilities (apply everywhere) ===== */
body { background: var(--bg); color: var(--text); }

/* Legacy compatibility for existing tokens */
:root {
  --text-strong: var(--text);
  --text-secondary: color-mix(in lab, var(--text) 70%, transparent);
  --divider: var(--glass-stroke);
  --control-border: var(--glass-stroke);
  --glass-tint: rgba(20,22,28,0.55);
  --glass-blur: 12px;
}

:root[data-theme="light"] {
  --text-strong: #1B2230;
  --text-secondary: #2C3446;
  --divider: #E7EBF3;
  --control-border: #9AA6B6;
  --glass-tint: rgba(255,255,255,0.65);
  --glass-blur: 12px;
}

:root[data-theme="dark"] {
  --text-strong: #F2F5F9;
  --text-secondary: #8B9299;
  --divider: color-mix(in lab, #F2F5F9 16%, transparent);
  --control-border: color-mix(in lab, #F2F5F9 35%, transparent);
  --glass-tint: rgba(20,22,28,0.55);
  --glass-blur: 14px;
}

:root[data-theme="high-contrast"] {
  --text-strong: #000000;
  --text-secondary: #000000;
  --divider: #000000;
  --control-border: #000000;
  --glass-tint: transparent;
  --glass-blur: 0px;
}

/* Apple-style glass panels (respect mode) */
.glass {
  background: var(--glass-tint);
  backdrop-filter: blur(var(--glass-blur));
  -webkit-backdrop-filter: blur(var(--glass-blur));
  border: 1px solid var(--glass-stroke);
  border-radius: 12px;
}

/* Text helpers */
.text-strong   { color: var(--text-strong); }
.text-secondary{ color: var(--text-secondary); }

/* Non-text contrast: use control-border on interactive shells */
.control {
  border: 1px solid var(--control-border);
  border-radius: 12px;
}

/* Dividers (hairline; can be lighter than 3:1) */
.divider { height:1px; background: var(--divider); }

/* Focus ring */
:focus-visible { outline: var(--focus-ring); outline-offset: 2px; }

/* Keep your existing layout/nav/button rules below this lineâ€¦ */

/* RESET + A11Y */
*{box-sizing:border-box} body{margin:0;background:var(--bg);color:var(--text);font-family:Inter,system-ui,Segoe UI,Arial,sans-serif}
:focus-visible{outline:var(--ring);outline-offset:2px}
.visually-hidden{position:absolute!important;width:1px;height:1px;margin:-1px;padding:0;overflow:hidden;clip:rect(0,0,0,0);white-space:nowrap;border:0}
.visually-hidden.focusable:focus{position:static!important;width:auto;height:auto;clip:auto}

/* TYPO */
h1,h2,h3{font-family:Montserrat,system-ui,sans-serif;line-height:1.15;margin:0 0 .5rem}
h1{font-size: clamp(2rem,4vw,3rem)} h2{font-size: clamp(1.35rem,2.2vw,1.75rem)} h3{font-size:1.125rem}
p{line-height:1.6;max-width:70ch}

/* LAYOUT */
.container{max-width:1040px;margin:0 auto;padding:0 1rem}
.section{padding: clamp(1.5rem,4vw,3rem) 0}

/* NAV */
.header{position:sticky;top:0;z-index:50;background:color-mix(in oklab,var(--surface) 85%, transparent);
  backdrop-filter: blur(12px);-webkit-backdrop-filter: blur(12px);border-bottom:1px solid var(--border)}
.nav{display:flex;gap:1rem;align-items:center;flex-wrap:wrap}
.nav a{text-decoration:none;color:var(--text-sub);padding:.65rem .25rem;display:inline-flex;align-items:center;gap:.35rem;position:relative}
.nav a[aria-current="page"]{color:var(--text)}

/* GLASS & HALO */
.glass{background:var(--glass-bg);backdrop-filter:blur(var(--glass-blur));-webkit-backdrop-filter:blur(var(--glass-blur));
  border:1px solid var(--border);border-radius:12px}
.halo-layer{position:relative;isolation:isolate}
.halo-layer::before{content:"";position:absolute;inset:-20%;
  background:radial-gradient(600px 600px at var(--mx,50%) var(--my,50%),
  color-mix(in oklab, var(--brand) 60%, transparent),transparent 60%);
  filter: blur(40px);z-index:-1;opacity:.55;transition:opacity var(--dur) var(--ease)}
@media(prefers-reduced-motion:reduce){.halo-layer::before{opacity:.35}}

/* GRIDS & CARDS */
.grid{display:grid;gap:1rem;grid-template-columns:repeat(auto-fit,minmax(240px,1fr))}
.card{border:1px solid var(--border);border-radius:12px;padding:1rem;background:#11131a;
  transition: transform var(--dur) var(--ease), box-shadow var(--dur) var(--ease)}
.card:hover{transform:translateY(-2px);box-shadow:0 8px 30px -12px rgba(0,0,0,.5)}

/* BUTTONS */
.btn{display:inline-flex;align-items:center;justify-content:center;padding:.65rem 1rem;border-radius:10px;border:1px solid var(--border);
  color:var(--text);background:linear-gradient(180deg,#1a1b22,#12131a);text-decoration:none;transition: transform var(--dur) var(--ease), box-shadow var(--dur) var(--ease)}
.btn:hover{transform:translateY(-1px)}
.btn-primary{background:linear-gradient(180deg,color-mix(in oklab,var(--brand) 56%, #1a1b22), #12131a)}
.btn-primary:hover{box-shadow:0 10px 40px -10px color-mix(in oklab,var(--brand) 50%, transparent)}

/* CHIPS */

.ripple { position:absolute; border-radius:50%; transform:scale(0);
  background: color-mix(in oklab, var(--brand) 60%, white 10%);
  opacity:.35; animation: ripple 450ms var(--ease) forwards; pointer-events:none; }
@keyframes ripple { to { transform:scale(2.5); opacity:0; } }

.card.glossy { position: relative; overflow: hidden; }
.card.glossy::after {
  content:""; position:absolute; inset:-20% -60%; transform: rotate(18deg) translateX(-120%);
  background: linear-gradient(90deg, transparent, rgba(255,255,255,.18), transparent);
  animation: shine 2600ms linear infinite;
}
@keyframes shine { to { transform: rotate(18deg) translateX(120%); } }

/* Animated underline on hover */
.nav a::after {
  content: '';
  position: absolute; left: 0; right: 0; bottom: .35rem;
  height: 2px; background: currentColor;
  transform: scaleX(0); transform-origin: left;
  transition: transform var(--dur) var(--ease);
  opacity: .9;
}
.nav a:hover::after, .nav a[aria-current="page"]::after { transform: scaleX(1); }
@media (prefers-reduced-motion: reduce) {
  .ripple { animation: none; opacity: .2; }
  .card.glossy::after { animation: none; }
  .nav a::after { transition: none; }
}

/* ===== Beams: light/dark with WCAG-friendly scrims ===== */
.beam-wrap { position: relative; isolation: isolate; }
.beam {
  position: absolute; inset: -10% -20%;
  z-index: -1;
  pointer-events: none;
  background:
    conic-gradient(from 180deg,
      color-mix(in oklab, var(--brand) 35%, transparent) 0 25%,
      color-mix(in oklab, var(--brand-2) 35%, transparent) 25% 50%,
      color-mix(in oklab, var(--brand-3) 35%, transparent) 50% 75%,
      transparent 75% 100%);
  filter: blur(72px) saturate(1.05);
  opacity: .38;
  animation: beam-shift 12s ease-in-out infinite alternate;
}
html[data-theme="light"] .beam { opacity: .28; }
html[data-theme="high-contrast"] .beam { opacity: .2; filter: none; }

.beam--dark { mix-blend-mode: screen; }
.beam--light { mix-blend-mode: multiply; }

@keyframes beam-shift { from { transform: translate3d(-2%, -1%, 0) } to { transform: translate3d(2%, 1%, 0) } }
@media (prefers-reduced-motion: reduce) {
  .beam { animation: none; }
}

/* Scrim to guarantee AA/AAA contrast on text over beams */
.scrim {
  background:
    linear-gradient(
      to bottom,
      color-mix(in lab, #000 55%, transparent) 0%,
      color-mix(in lab, #000 35%, transparent) 40%,
      transparent 100%
    );
}
html[data-theme="light"] .scrim {
  background:
    linear-gradient(
      to bottom,
      color-mix(in lab, #fff 75%, transparent) 0%,
      color-mix(in lab, #fff 55%, transparent) 40%,
      transparent 100%
    );
}
/* In HC, scrim becomes solid for guaranteed contrast */
html[data-theme="high-contrast-dark"] .scrim { background:#000; color:#fff; }
html[data-theme="high-contrast-light"] .scrim { background:#fff; color:#000; }

/* Link states */
a { color: color-mix(in lab, var(--brand) 60%, var(--text) 40%); }
a:hover { text-decoration: underline; }
a:focus-visible { outline: var(--focus-ring); }

/* Skip link visible when tabbing */
.visually-hidden.focusable:focus {
  position: fixed !important;
  top: .5rem; left: .5rem;
  background: var(--bg-elev-1);
  color: var(--text);
  padding: .5rem .75rem;
  border: 2px solid var(--control-border);
  border-radius: .5rem;
  z-index: 9999;
}
