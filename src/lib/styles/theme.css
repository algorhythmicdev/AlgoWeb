/* =========================================================
   MODES, TOKENS & ELEVATIONS (AAA text, ≥3:1 non-text)
   ---------------------------------------------------------
   Elevations:
   - --bg          : page background
   - --bg-elev-1   : cards / shell panels
   - --bg-elev-2   : sub-panels / alt sections
   Typography:
   - --text        : body text (AAA)
   - --text-strong : headings / emphasis (AAA)
   - --text-secondary : muted (still AAA in Dark; AA+ in Light)
   Non-text:
   - --divider     : hairline separators (can be <3:1)
   - --control-border : interactive borders (≥3:1)
   Focus:
   - --focus-ring  : 3px high-contrast ring in HC modes
   ========================================================= */

/* ---------- LIGHT (default) ---------- */
:root,
html[data-theme="light"] {
  /* Surfaces */
  --bg:            #F5F7FB; /* Cloud */
  --bg-elev-1:     #FFFFFF; /* Surface */
  --bg-elev-2:     #E7EBF3; /* Mist */

  /* Text */
  --text:          #0A0D14; /* Ink (AAA on Cloud/Surface/Mist) */
  --text-strong:   #1B2230; /* Slate (AAA) */
  --text-secondary:#2C3446; /* Muted; darker than Slate to keep ≥AA/AAA */

  /* Non-text (≥3:1 for controls) */
  --divider:       #E7EBF3; /* hairline separators */
  /* On white (#fff), 3:1 needs roughly <=#A7B1C0.
     We'll split: control borders stronger; dividers can stay lighter */
  --control-border:#9AA6B6; /* ≥3:1 vs #fff and #F5F7FB */

  /* Brand (for beams / accents) */
  --brand:   #8B5CF6;
  --brand-2: #06B6D4;
  --brand-3: #22C55E;

  /* Effects */
  --glass-tint: rgba(255,255,255,0.65);    /* Apple-style translucency */
  --glass-stroke: color-mix(in lab, #000 10%, transparent);
  --glass-blur: 12px;

  /* Motion & focus */
  --dur-fast: 140ms;
  --dur:      200ms;
  --dur-slow: 360ms;
  --ease: cubic-bezier(.2,.7,.2,1);
  --focus-ring: 2px solid color-mix(in lab, var(--brand) 70%, black 10%);
}

/* ---------- DARK ---------- */
html[data-theme="dark"] {
  /* Surfaces */
  --bg:            #0B0E13; /* Night */
  --bg-elev-1:     #1A1D23; /* Graphite */
  --bg-elev-2:     #161C28; /* sub-panel */

  /* Text */
  --text:          #F2F5F9; /* Snow (AAA) */
  --text-strong:   #F2F5F9; /* strong = body in dark */
  --text-secondary:#8B9299; /* Ash (target AAA on Night / AA+ on elev) */

  /* Non-text (≥3:1 for controls) */
  /* Light borders mixed from Snow so they clear 3:1 on Graphite */
  --divider:       color-mix(in lab, #F2F5F9 16%, transparent);
  --control-border:color-mix(in lab, #F2F5F9 35%, transparent);

  /* Brand */
  --brand:   #8B5CF6;
  --brand-2: #06B6D4;
  --brand-3: #22C55E;

  /* Effects */
  --glass-tint: rgba(20,22,28,0.55);
  --glass-stroke: color-mix(in lab, #fff 12%, transparent);
  --glass-blur: 14px;

  /* Focus */
  --focus-ring: 2px solid color-mix(in lab, #F2F5F9 80%, var(--brand) 20%);
}

/* ---------- HIGH-CONTRAST (two explicit variants) ---------- */
/* High-contrast DARK (white on black) */
html[data-theme="high-contrast-dark"] {
  --bg:            #000000;
  --bg-elev-1:     #000000; /* flatten depth */
  --bg-elev-2:     #0F0F0F; /* slight separation */
  --text:          #FFFFFF;
  --text-strong:   #FFFFFF;
  --text-secondary:#FFFFFF;
  --divider:       #FFFFFF;
  --control-border:#FFFFFF;

  --glass-tint: transparent; /* disable translucency */
  --glass-stroke: #FFFFFF;
  --glass-blur: 0px;

  --brand: #FFFFFF; --brand-2: #FFFFFF; --brand-3: #FFFFFF;
  --focus-ring: 3px solid #FFFFFF;
}

/* High-contrast LIGHT (black on white) */
html[data-theme="high-contrast-light"] {
  --bg:            #FFFFFF;
  --bg-elev-1:     #FFFFFF;
  --bg-elev-2:     #F2F2F2;
  --text:          #000000;
  --text-strong:   #000000;
  --text-secondary:#000000;
  --divider:       #000000;
  --control-border:#000000;

  --glass-tint: transparent;
  --glass-stroke: #000000;
  --glass-blur: 0px;

  --brand: #000000; --brand-2:#000000; --brand-3:#000000;
  --focus-ring: 3px solid #000000;
}

/* ===== Elevation utilities (apply everywhere) ===== */
body { background: var(--bg); color: var(--text); }

.surface-0 { background: var(--bg); }
.surface-1 { background: var(--bg-elev-1); }
.surface-2 { background: var(--bg-elev-2); }

/* Apple-style glass panels (respect mode) */
.glass {
  background: var(--glass-tint);
  backdrop-filter: blur(var(--glass-blur));
  -webkit-backdrop-filter: blur(var(--glass-blur));
  border: 1px solid var(--glass-stroke);
  border-radius: 12px;
}

/* Text helpers */
.text-strong   { color: var(--text-strong); }
.text-secondary{ color: var(--text-secondary); }

/* Non-text contrast: use control-border on interactive shells */
.control {
  border: 1px solid var(--control-border);
  border-radius: 12px;
}

/* Dividers (hairline; can be lighter than 3:1) */
.divider { height:1px; background: var(--divider); }

/* Focus ring */
:focus-visible { outline: var(--focus-ring); outline-offset: 2px; }

/* Keep your existing layout/nav/button rules below this line… */

/* RESET + A11Y */
*{box-sizing:border-box} body{margin:0;background:var(--bg);color:var(--text);font-family:Inter,system-ui,Segoe UI,Arial,sans-serif}
:focus-visible{outline:var(--ring);outline-offset:2px}
.visually-hidden{position:absolute!important;width:1px;height:1px;margin:-1px;padding:0;overflow:hidden;clip:rect(0,0,0,0);white-space:nowrap;border:0}
.visually-hidden.focusable:focus{position:static!important;width:auto;height:auto;clip:auto}

/* TYPO */
h1,h2,h3{font-family:Montserrat,system-ui,sans-serif;line-height:1.15;margin:0 0 .5rem}
h1{font-size: clamp(2rem,4vw,3rem)} h2{font-size: clamp(1.35rem,2.2vw,1.75rem)} h3{font-size:1.125rem}
p{line-height:1.6;max-width:70ch}

/* LAYOUT */
.container{max-width:1040px;margin:0 auto;padding:0 1rem}
.section{padding: clamp(1.5rem,4vw,3rem) 0}

/* NAV */
.header{position:sticky;top:0;z-index:50;background:color-mix(in oklab,var(--surface) 85%, transparent);
  backdrop-filter: blur(12px);-webkit-backdrop-filter: blur(12px);border-bottom:1px solid var(--border)}
.nav{display:flex;gap:1rem;align-items:center;flex-wrap:wrap}
.nav a{text-decoration:none;color:var(--text-sub);padding:.65rem .25rem;display:inline-flex;align-items:center;gap:.35rem;position:relative}
.nav a[aria-current="page"]{color:var(--text)}

/* GLASS & HALO */
.glass{background:var(--glass-bg);backdrop-filter:blur(var(--glass-blur));-webkit-backdrop-filter:blur(var(--glass-blur));
  border:1px solid var(--border);border-radius:12px}
.halo-layer{position:relative;isolation:isolate}
.halo-layer::before{content:"";position:absolute;inset:-20%;
  background:radial-gradient(600px 600px at var(--mx,50%) var(--my,50%),
  color-mix(in oklab, var(--brand) 60%, transparent),transparent 60%);
  filter: blur(40px);z-index:-1;opacity:.55;transition:opacity var(--dur) var(--ease)}
@media(prefers-reduced-motion:reduce){.halo-layer::before{opacity:.35}}

/* GRIDS & CARDS */
.grid{display:grid;gap:1rem;grid-template-columns:repeat(auto-fit,minmax(240px,1fr))}
.card{border:1px solid var(--border);border-radius:12px;padding:1rem;background:#11131a;
  transition: transform var(--dur) var(--ease), box-shadow var(--dur) var(--ease)}
.card:hover{transform:translateY(-2px);box-shadow:0 8px 30px -12px rgba(0,0,0,.5)}

/* BUTTONS */
.btn{display:inline-flex;align-items:center;justify-content:center;padding:.65rem 1rem;border-radius:10px;border:1px solid var(--border);
  color:var(--text);background:linear-gradient(180deg,#1a1b22,#12131a);text-decoration:none;transition: transform var(--dur) var(--ease), box-shadow var(--dur) var(--ease)}
.btn:hover{transform:translateY(-1px)}
.btn-primary{background:linear-gradient(180deg,color-mix(in oklab,var(--brand) 56%, #1a1b22), #12131a)}
.btn-primary:hover{box-shadow:0 10px 40px -10px color-mix(in oklab,var(--brand) 50%, transparent)}

/* CHIPS */

.ripple { position:absolute; border-radius:50%; transform:scale(0);
  background: color-mix(in oklab, var(--brand) 60%, white 10%);
  opacity:.35; animation: ripple 450ms var(--ease) forwards; pointer-events:none; }
@keyframes ripple { to { transform:scale(2.5); opacity:0; } }

.card.glossy { position: relative; overflow: hidden; }
.card.glossy::after {
  content:""; position:absolute; inset:-20% -60%; transform: rotate(18deg) translateX(-120%);
  background: linear-gradient(90deg, transparent, rgba(255,255,255,.18), transparent);
  animation: shine 2600ms linear infinite;
}
@keyframes shine { to { transform: rotate(18deg) translateX(120%); } }

/* Animated underline on hover */
.nav a::after {
  content: '';
  position: absolute; left: 0; right: 0; bottom: .35rem;
  height: 2px; background: currentColor;
  transform: scaleX(0); transform-origin: left;
  transition: transform var(--dur) var(--ease);
  opacity: .9;
}
.nav a:hover::after, .nav a[aria-current="page"]::after { transform: scaleX(1); }
@media (prefers-reduced-motion: reduce) {
  .ripple { animation: none; opacity: .2; }
  .card.glossy::after { animation: none; }
  .nav a::after { transition: none; }
}

/* ===== Beams: light/dark with WCAG-friendly scrims ===== */
.beam-wrap { position: relative; isolation: isolate; }
.beam {
  position: absolute; inset: -10% -20%;
  z-index: -1;
  pointer-events: none;
  background:
    conic-gradient(from 180deg,
      color-mix(in oklab, var(--brand) 35%, transparent) 0 25%,
      color-mix(in oklab, var(--brand-2) 35%, transparent) 25% 50%,
      color-mix(in oklab, var(--brand-3) 35%, transparent) 50% 75%,
      transparent 75% 100%);
  filter: blur(72px) saturate(1.05);
  opacity: .38;
  animation: beam-shift 12s ease-in-out infinite alternate;
}
html[data-theme="light"] .beam { opacity: .28; }
html[data-theme="high-contrast"] .beam { opacity: .2; filter: none; }

.beam--dark { mix-blend-mode: screen; }
.beam--light { mix-blend-mode: multiply; }

@keyframes beam-shift { from { transform: translate3d(-2%, -1%, 0) } to { transform: translate3d(2%, 1%, 0) } }
@media (prefers-reduced-motion: reduce) {
  .beam { animation: none; }
}

/* Scrim to guarantee AA/AAA contrast on text over beams */
.scrim {
  background:
    linear-gradient(
      to bottom,
      color-mix(in lab, #000 55%, transparent) 0%,
      color-mix(in lab, #000 35%, transparent) 40%,
      transparent 100%
    );
}
html[data-theme="light"] .scrim {
  background:
    linear-gradient(
      to bottom,
      color-mix(in lab, #fff 75%, transparent) 0%,
      color-mix(in lab, #fff 55%, transparent) 40%,
      transparent 100%
    );
}
/* In HC, scrim becomes solid for guaranteed contrast */
html[data-theme="high-contrast-dark"] .scrim { background:#000; color:#fff; }
html[data-theme="high-contrast-light"] .scrim { background:#fff; color:#000; }
